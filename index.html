<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Tailwind Css -->
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <!-- Pagination Css -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/paginationjs@2.6.0/dist/pagination.css" />
    <!-- Title -->
    <title>Api Example Pagination</title>
  </head>
  <body class="min-h-screen bg-gray-100 flex items-center justify-center">
    <div class="bg-white p-8 rounded-lg shadow-lg max-w-4xl w-full">
      <!-- Contenedor Fuente  -->
      <div class="text-xs mb-5 md:mb-8 text-left md:text-right">
        <span class="text-gray-500">Fuente:</span>
        <a href="https://jsonplaceholder.typicode.com/posts" target="_blank" class="text-blue-600 hover:underline">
          jsonplaceholder.typicode.com/posts
        </a>
      </div>
      <!-- Contenedor de Posts (Aquí se renderizaran) -->
      <div id="posts" class="mb-9"></div>
      <!-- Contenedor de la Paginación -->
      <div id="pagination-container"></div>
    </div>
    <!-- Jquery 3.6.0 -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Pagination.js 2.6.0 -->
    <script src="https://cdn.jsdelivr.net/npm/paginationjs@2.6.0/dist/pagination.min.js"></script>
    <!-- Consumo de Api-->
    <script>
      // Variable global para almacenar todos los datos de la api
      let allPosts = [];
      // Función asyncrona para obtener los datos
      async function getPosts() {
        try {
          const response = await fetch('https://jsonplaceholder.typicode.com/posts');
          // Verifica si la respuesta fue exitosa (200), si no, muestra el error
          if (!response.ok) throw new Error('Error al obtener los datos');
          // Convierte la respuesta a json
          allPosts = await response.json();
          // Inicializar la paginación con todos los datos
          $('#pagination-container').pagination({
            dataSource: allPosts,
            pageSize: 5, // posts por página
            callback: function (data, pagination) {
              // Llama div id posts
              const postsContainer = document.getElementById('posts');
              // Incluye el título en cada renderizado
              let html = '<h1 class="text-2xl font-semibold mb-8 text-gray-700">Lista de publicaciones</h1>';
              // Renderiza los post de la página actual en div id posts
              data.forEach(({ id, title, body }) => {
                html += `
                    <div class="border border-gray-300 rounded-md p-4 mb-4 shadow-sm hover:shadow-md transition-shadow duration-300">
                        <h2 class="text-md font-semibold mb-2 text-gray-700">${id}.- ${title.toUpperCase()}</h2>
                        <p class="text-gray-400">${body}</p>
                    </div>
                `;
              });
              postsContainer.innerHTML = html;
            },
          });
        } catch (error) {
          // Muestra error en consola si hay un error en la perición
          console.error('Hubo un problema, al realizar la petición:', error);
        }
      }
      //Llama a la funcion
      getPosts();
    </script>
  </body>
</html>
